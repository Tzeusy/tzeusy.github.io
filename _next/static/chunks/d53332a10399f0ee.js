(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78058,e=>{"use strict";var t=e.i(21161),i=e.i(67623),a=function(e){function t(){var e;return(0,i.b)(this,t),(e=(0,i.c)(this,t)).rawEmitter=e,e}return(0,i._)(t,e),(0,i.a)(t)}(e.i(19298).EventEmitter),n=e.i(78251),r=e.i(17022),s={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},o={easing:"quadraticInOut",duration:150};function h(){return Float32Array.of(1,0,0,0,1,0,0,0,1)}function d(e,t,i){return e[0]=t,e[4]="number"==typeof i?i:t,e}function l(e,t){var i=Math.sin(t),a=Math.cos(t);return e[0]=a,e[1]=i,e[3]=-i,e[4]=a,e}function u(e,t,i){return e[6]=t,e[7]=i,e}function c(e,t){var i=e[0],a=e[1],n=e[2],r=e[3],s=e[4],o=e[5],h=e[6],d=e[7],l=e[8],u=t[0],c=t[1],g=t[2],v=t[3],m=t[4],f=t[5],p=t[6],y=t[7],b=t[8];return e[0]=u*i+c*r+g*h,e[1]=u*a+c*s+g*d,e[2]=u*n+c*o+g*l,e[3]=v*i+m*r+f*h,e[4]=v*a+m*s+f*d,e[5]=v*n+m*o+f*l,e[6]=p*i+y*r+b*h,e[7]=p*a+y*s+b*d,e[8]=p*n+y*o+b*l,e}function g(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=e[0],n=e[1],r=e[3],s=e[4],o=e[6],h=e[7],d=t.x,l=t.y;return{x:d*a+l*r+o*i,y:d*n+l*s+h*i}}function v(e,t,i,a,n){var r,s,o=e.angle,g=e.ratio,v=e.x,m=e.y,f=t.width,p=t.height,y=h(),b=Math.min(f,p)-2*a,x=(r=t.height/t.width,s=i.height/i.width,r<1&&s>1||r>1&&s<1?1:Math.min(Math.max(s,1/s),Math.max(1/r,r)));return n?(c(y,u(h(),v,m)),c(y,d(h(),g)),c(y,l(h(),o)),c(y,d(h(),f/b/2/x,p/b/2/x))):(c(y,d(h(),b/f*2*x,b/p*2*x)),c(y,l(h(),-o)),c(y,d(h(),1/g)),c(y,u(h(),-v,-m))),y}function m(){return void 0!==window.devicePixelRatio?window.devicePixelRatio:1}function f(e,t,i){return i.sort(function(e,i){var a=t(e)||0,n=t(i)||0;return a<n?-1:+(a>n)})}function p(e){var t=(0,r._)(e.x,2),i=t[0],a=t[1],n=(0,r._)(e.y,2),s=n[0],o=n[1],h=Math.max(a-i,o-s),d=(a+i)/2,l=(o+s)/2;(0===h||Math.abs(h)===1/0||isNaN(h))&&(h=1),isNaN(d)&&(d=0),isNaN(l)&&(l=0);var u=function(e){return{x:.5+(e.x-d)/h,y:.5+(e.y-l)/h}};return u.applyTo=function(e){e.x=.5+(e.x-d)/h,e.y=.5+(e.y-l)/h},u.inverse=function(e){return{x:d+h*(e.x-.5),y:l+h*(e.y-.5)}},u.ratio=h,u}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){var i=t.size;if(0!==i){var a=e.length;e.length+=i;var n=0;t.forEach(function(t){e[a+n]=t,n++})}}function x(e){e=e||{};for(var t=0,i=arguments.length<=1?0:arguments.length-1;t<i;t++){var a=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];a&&Object.assign(e,a)}return e}var C={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,enableEdgeEvents:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,defaultDrawEdgeLabel:t.d,defaultDrawNodeLabel:t.b,defaultDrawNodeHover:t.c,minEdgeThickness:1.7,antiAliasingFeather:1,dragTimeout:100,draggedEventsTolerance:3,inertiaDuration:200,inertiaRatio:3,zoomDuration:250,zoomingRatio:1.7,doubleClickTimeout:300,doubleClickZoomingRatio:2.2,doubleClickZoomingDuration:200,tapMoveTolerance:10,zoomToSizeRatioFunction:Math.sqrt,itemSizesReference:"screen",autoRescale:!0,autoCenter:!0,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,nodeReducer:null,edgeReducer:null,zIndex:!1,minCameraRatio:null,maxCameraRatio:null,enableCameraZooming:!0,enableCameraPanning:!0,enableCameraRotation:!0,cameraPanBoundaries:null,allowInvalidContainer:!1,nodeProgramClasses:{},nodeHoverProgramClasses:{},edgeProgramClasses:{}},w={circle:t.N},E={arrow:t.E,line:t.e};function k(e){if("number"!=typeof e.labelDensity||e.labelDensity<0)throw Error("Settings: invalid `labelDensity`. Expecting a positive number.");var t=e.minCameraRatio,i=e.maxCameraRatio;if("number"==typeof t&&"number"==typeof i&&i<t)throw Error("Settings: invalid camera ratio boundaries. Expecting `maxCameraRatio` to be greater than `minCameraRatio`.")}var L=function(e){function a(){var e;return(0,i.b)(this,a),e=(0,i.c)(this,a),(0,t.a)(e,"x",.5),(0,t.a)(e,"y",.5),(0,t.a)(e,"angle",0),(0,t.a)(e,"ratio",1),(0,t.a)(e,"minRatio",null),(0,t.a)(e,"maxRatio",null),(0,t.a)(e,"enabledZooming",!0),(0,t.a)(e,"enabledPanning",!0),(0,t.a)(e,"enabledRotation",!0),(0,t.a)(e,"clean",null),(0,t.a)(e,"nextFrame",null),(0,t.a)(e,"previousState",null),(0,t.a)(e,"enabled",!0),e.previousState=e.getState(),e}return(0,i._)(a,e),(0,i.a)(a,[{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"getState",value:function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}}},{key:"hasState",value:function(e){return this.x===e.x&&this.y===e.y&&this.ratio===e.ratio&&this.angle===e.angle}},{key:"getPreviousState",value:function(){var e=this.previousState;return e?{x:e.x,y:e.y,angle:e.angle,ratio:e.ratio}:null}},{key:"getBoundedRatio",value:function(e){var t=e;return"number"==typeof this.minRatio&&(t=Math.max(t,this.minRatio)),"number"==typeof this.maxRatio&&(t=Math.min(t,this.maxRatio)),t}},{key:"validateState",value:function(e){var i={};return this.enabledPanning&&"number"==typeof e.x&&(i.x=e.x),this.enabledPanning&&"number"==typeof e.y&&(i.y=e.y),this.enabledZooming&&"number"==typeof e.ratio&&(i.ratio=this.getBoundedRatio(e.ratio)),this.enabledRotation&&"number"==typeof e.angle&&(i.angle=e.angle),this.clean?this.clean((0,t._)((0,t._)({},this.getState()),i)):i}},{key:"isAnimated",value:function(){return!!this.nextFrame}},{key:"setState",value:function(e){if(!this.enabled)return this;this.previousState=this.getState();var t=this.validateState(e);return"number"==typeof t.x&&(this.x=t.x),"number"==typeof t.y&&(this.y=t.y),"number"==typeof t.ratio&&(this.ratio=t.ratio),"number"==typeof t.angle&&(this.angle=t.angle),this.hasState(this.previousState)||this.emit("updated",this.getState()),this}},{key:"updateState",value:function(e){return this.setState(e(this.getState())),this}},{key:"animate",value:function(e){var i=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(!n)return new Promise(function(t){return i.animate(e,a,t)});if(this.enabled){var r=(0,t._)((0,t._)({},o),a),h=this.validateState(e),d="function"==typeof r.easing?r.easing:s[r.easing],l=Date.now(),u=this.getState(),c=function(){var e=(Date.now()-l)/r.duration;if(e>=1){i.nextFrame=null,i.setState(h),i.animationCallback&&(i.animationCallback.call(null),i.animationCallback=void 0);return}var t=d(e),a={};"number"==typeof h.x&&(a.x=u.x+(h.x-u.x)*t),"number"==typeof h.y&&(a.y=u.y+(h.y-u.y)*t),i.enabledRotation&&"number"==typeof h.angle&&(a.angle=u.angle+(h.angle-u.angle)*t),"number"==typeof h.ratio&&(a.ratio=u.ratio+(h.ratio-u.ratio)*t),i.setState(a),i.nextFrame=requestAnimationFrame(c)};this.nextFrame?(cancelAnimationFrame(this.nextFrame),this.animationCallback&&this.animationCallback.call(null),this.nextFrame=requestAnimationFrame(c)):c(),this.animationCallback=n}}},{key:"animatedZoom",value:function(e){return e?"number"==typeof e?this.animate({ratio:this.ratio/e}):this.animate({ratio:this.ratio/(e.factor||1.5)},e):this.animate({ratio:this.ratio/1.5})}},{key:"animatedUnzoom",value:function(e){return e?"number"==typeof e?this.animate({ratio:this.ratio*e}):this.animate({ratio:this.ratio*(e.factor||1.5)},e):this.animate({ratio:1.5*this.ratio})}},{key:"animatedReset",value:function(e){return this.animate({x:.5,y:.5,ratio:1,angle:0},e)}},{key:"copy",value:function(){return a.from(this.getState())}}],[{key:"from",value:function(e){return new a().setState(e)}}])}(a);function S(e,t){var i=t.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}}function P(e,i){var a=(0,t._)((0,t._)({},S(e,i)),{},{sigmaDefaultPrevented:!1,preventSigmaDefault:function(){a.sigmaDefaultPrevented=!0},original:e});return a}function T(e){var i="x"in e?e:(0,t._)((0,t._)({},e.touches[0]||e.previousTouches[0]),{},{original:e.original,sigmaDefaultPrevented:e.sigmaDefaultPrevented,preventSigmaDefault:function(){e.sigmaDefaultPrevented=!0,i.sigmaDefaultPrevented=!0}});return i}function D(e){for(var t=[],i=0,a=Math.min(e.length,2);i<a;i++)t.push(e[i]);return t}function R(e,t,i){var a={touches:D(e.touches).map(function(e){return S(e,i)}),previousTouches:t.map(function(e){return S(e,i)}),sigmaDefaultPrevented:!1,preventSigmaDefault:function(){a.sigmaDefaultPrevented=!0},original:e};return a}function N(e){if(void 0!==e.deltaY)return -3*e.deltaY/360;if(void 0!==e.detail)return-(e.detail/9);throw Error("Captor: could not extract delta from event.")}var M=function(e){function t(e,a){var n;return(0,i.b)(this,t),(n=(0,i.c)(this,t)).container=e,n.renderer=a,n}return(0,i._)(t,e),(0,i.a)(t)}(a),G=["doubleClickTimeout","doubleClickZoomingDuration","doubleClickZoomingRatio","dragTimeout","draggedEventsTolerance","inertiaDuration","inertiaRatio","zoomDuration","zoomingRatio"].reduce(function(e,i){return(0,t._)((0,t._)({},e),{},(0,t.a)({},i,C[i]))},{}),F=function(e){function a(e,n){var r;return(0,i.b)(this,a),r=(0,i.c)(this,a,[e,n]),(0,t.a)(r,"enabled",!0),(0,t.a)(r,"draggedEvents",0),(0,t.a)(r,"downStartTime",null),(0,t.a)(r,"lastMouseX",null),(0,t.a)(r,"lastMouseY",null),(0,t.a)(r,"isMouseDown",!1),(0,t.a)(r,"isMoving",!1),(0,t.a)(r,"movingTimeout",null),(0,t.a)(r,"startCameraState",null),(0,t.a)(r,"clicks",0),(0,t.a)(r,"doubleClickTimeout",null),(0,t.a)(r,"currentWheelDirection",0),(0,t.a)(r,"settings",G),r.handleClick=r.handleClick.bind(r),r.handleRightClick=r.handleRightClick.bind(r),r.handleDown=r.handleDown.bind(r),r.handleUp=r.handleUp.bind(r),r.handleMove=r.handleMove.bind(r),r.handleWheel=r.handleWheel.bind(r),r.handleLeave=r.handleLeave.bind(r),r.handleEnter=r.handleEnter.bind(r),e.addEventListener("click",r.handleClick,{capture:!1}),e.addEventListener("contextmenu",r.handleRightClick,{capture:!1}),e.addEventListener("mousedown",r.handleDown,{capture:!1}),e.addEventListener("wheel",r.handleWheel,{capture:!1}),e.addEventListener("mouseleave",r.handleLeave,{capture:!1}),e.addEventListener("mouseenter",r.handleEnter,{capture:!1}),document.addEventListener("mousemove",r.handleMove,{capture:!1}),document.addEventListener("mouseup",r.handleUp,{capture:!1}),r}return(0,i._)(a,e),(0,i.a)(a,[{key:"kill",value:function(){var e=this.container;e.removeEventListener("click",this.handleClick),e.removeEventListener("contextmenu",this.handleRightClick),e.removeEventListener("mousedown",this.handleDown),e.removeEventListener("wheel",this.handleWheel),e.removeEventListener("mouseleave",this.handleLeave),e.removeEventListener("mouseenter",this.handleEnter),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)}},{key:"handleClick",value:function(e){var t=this;if(this.enabled){if(this.clicks++,2===this.clicks)return this.clicks=0,"number"==typeof this.doubleClickTimeout&&(clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null),this.handleDoubleClick(e);setTimeout(function(){t.clicks=0,t.doubleClickTimeout=null},this.settings.doubleClickTimeout),this.draggedEvents<this.settings.draggedEventsTolerance&&this.emit("click",P(e,this.container))}}},{key:"handleRightClick",value:function(e){this.enabled&&this.emit("rightClick",P(e,this.container))}},{key:"handleDoubleClick",value:function(e){if(this.enabled){e.preventDefault(),e.stopPropagation();var t=P(e,this.container);if(this.emit("doubleClick",t),!t.sigmaDefaultPrevented){var i=this.renderer.getCamera(),a=i.getBoundedRatio(i.getState().ratio/this.settings.doubleClickZoomingRatio);i.animate(this.renderer.getViewportZoomedState(S(e,this.container),a),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}}},{key:"handleDown",value:function(e){if(this.enabled){if(0===e.button){this.startCameraState=this.renderer.getCamera().getState();var t=S(e,this.container),i=t.x,a=t.y;this.lastMouseX=i,this.lastMouseY=a,this.draggedEvents=0,this.downStartTime=Date.now(),this.isMouseDown=!0}this.emit("mousedown",P(e,this.container))}}},{key:"handleUp",value:function(e){var t=this;if(this.enabled&&this.isMouseDown){var i=this.renderer.getCamera();this.isMouseDown=!1,"number"==typeof this.movingTimeout&&(clearTimeout(this.movingTimeout),this.movingTimeout=null);var a=S(e,this.container),n=a.x,r=a.y,s=i.getState(),o=i.getPreviousState()||{x:0,y:0};this.isMoving?i.animate({x:s.x+this.settings.inertiaRatio*(s.x-o.x),y:s.y+this.settings.inertiaRatio*(s.y-o.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"}):(this.lastMouseX!==n||this.lastMouseY!==r)&&i.setState({x:s.x,y:s.y}),this.isMoving=!1,setTimeout(function(){var e=t.draggedEvents>0;t.draggedEvents=0,e&&t.renderer.getSetting("hideEdgesOnMove")&&t.renderer.refresh()},0),this.emit("mouseup",P(e,this.container))}}},{key:"handleMove",value:function(e){var t=this;if(this.enabled){var i=P(e,this.container);if(this.emit("mousemovebody",i),(e.target===this.container||e.composedPath()[0]===this.container)&&this.emit("mousemove",i),!i.sigmaDefaultPrevented&&this.isMouseDown){this.isMoving=!0,this.draggedEvents++,"number"==typeof this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){t.movingTimeout=null,t.isMoving=!1},this.settings.dragTimeout);var a=this.renderer.getCamera(),n=S(e,this.container),r=n.x,s=n.y,o=this.renderer.viewportToFramedGraph({x:this.lastMouseX,y:this.lastMouseY}),h=this.renderer.viewportToFramedGraph({x:r,y:s}),d=o.x-h.x,l=o.y-h.y,u=a.getState(),c=u.x+d,g=u.y+l;a.setState({x:c,y:g}),this.lastMouseX=r,this.lastMouseY=s,e.preventDefault(),e.stopPropagation()}}}},{key:"handleLeave",value:function(e){this.emit("mouseleave",P(e,this.container))}},{key:"handleEnter",value:function(e){this.emit("mouseenter",P(e,this.container))}},{key:"handleWheel",value:function(e){var i,a=this,n=this.renderer.getCamera();if(this.enabled&&n.enabledZooming){var r=N(e);if(r){var s=(i=this.container,(0,t._)((0,t._)({},P(e,i)),{},{delta:N(e)}));if(this.emit("wheel",s),s.sigmaDefaultPrevented){e.preventDefault(),e.stopPropagation();return}var o=n.getState().ratio,h=r>0?1/this.settings.zoomingRatio:this.settings.zoomingRatio,d=n.getBoundedRatio(o*h),l=r>0?1:-1,u=Date.now();o===d||(e.preventDefault(),e.stopPropagation(),this.currentWheelDirection===l&&this.lastWheelTriggerTime&&u-this.lastWheelTriggerTime<this.settings.zoomDuration/5||(n.animate(this.renderer.getViewportZoomedState(S(e,this.container),d),{easing:"quadraticOut",duration:this.settings.zoomDuration},function(){a.currentWheelDirection=0}),this.currentWheelDirection=l,this.lastWheelTriggerTime=u))}}}},{key:"setSettings",value:function(e){this.settings=e}}])}(M),z=["dragTimeout","inertiaDuration","inertiaRatio","doubleClickTimeout","doubleClickZoomingRatio","doubleClickZoomingDuration","tapMoveTolerance"].reduce(function(e,i){return(0,t._)((0,t._)({},e),{},(0,t.a)({},i,C[i]))},{}),I=function(e){function a(e,n){var r;return(0,i.b)(this,a),r=(0,i.c)(this,a,[e,n]),(0,t.a)(r,"enabled",!0),(0,t.a)(r,"isMoving",!1),(0,t.a)(r,"hasMoved",!1),(0,t.a)(r,"touchMode",0),(0,t.a)(r,"startTouchesPositions",[]),(0,t.a)(r,"lastTouches",[]),(0,t.a)(r,"lastTap",null),(0,t.a)(r,"settings",z),r.handleStart=r.handleStart.bind(r),r.handleLeave=r.handleLeave.bind(r),r.handleMove=r.handleMove.bind(r),e.addEventListener("touchstart",r.handleStart,{capture:!1}),e.addEventListener("touchcancel",r.handleLeave,{capture:!1}),document.addEventListener("touchend",r.handleLeave,{capture:!1,passive:!1}),document.addEventListener("touchmove",r.handleMove,{capture:!1,passive:!1}),r}return(0,i._)(a,e),(0,i.a)(a,[{key:"kill",value:function(){var e=this.container;e.removeEventListener("touchstart",this.handleStart),e.removeEventListener("touchcancel",this.handleLeave),document.removeEventListener("touchend",this.handleLeave),document.removeEventListener("touchmove",this.handleMove)}},{key:"getDimensions",value:function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}}},{key:"handleStart",value:function(e){var t=this;if(this.enabled){e.preventDefault();var i=D(e.touches);if(this.touchMode=i.length,this.startCameraState=this.renderer.getCamera().getState(),this.startTouchesPositions=i.map(function(e){return S(e,t.container)}),2===this.touchMode){var a=(0,r._)(this.startTouchesPositions,2),n=a[0],s=n.x,o=n.y,h=a[1],d=h.x,l=h.y;this.startTouchesAngle=Math.atan2(l-o,d-s),this.startTouchesDistance=Math.sqrt(Math.pow(d-s,2)+Math.pow(l-o,2))}this.emit("touchdown",R(e,this.lastTouches,this.container)),this.lastTouches=i,this.lastTouchesPositions=this.startTouchesPositions}}},{key:"handleLeave",value:function(e){if(this.enabled&&this.startTouchesPositions.length){switch(e.cancelable&&e.preventDefault(),this.movingTimeout&&(this.isMoving=!1,clearTimeout(this.movingTimeout)),this.touchMode){case 2:if(1===e.touches.length){this.handleStart(e),e.preventDefault();break}case 1:if(this.isMoving){var t=this.renderer.getCamera(),i=t.getState(),a=t.getPreviousState()||{x:0,y:0};t.animate({x:i.x+this.settings.inertiaRatio*(i.x-a.x),y:i.y+this.settings.inertiaRatio*(i.y-a.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"})}this.hasMoved=!1,this.isMoving=!1,this.touchMode=0}if(this.emit("touchup",R(e,this.lastTouches,this.container)),!e.touches.length){var n=S(this.lastTouches[0],this.container),r=this.startTouchesPositions[0],s=Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2);if(!e.touches.length&&s<Math.pow(this.settings.tapMoveTolerance,2))if(this.lastTap&&Date.now()-this.lastTap.time<this.settings.doubleClickTimeout){var o=R(e,this.lastTouches,this.container);if(this.emit("doubletap",o),this.lastTap=null,!o.sigmaDefaultPrevented){var h=this.renderer.getCamera(),d=h.getBoundedRatio(h.getState().ratio/this.settings.doubleClickZoomingRatio);h.animate(this.renderer.getViewportZoomedState(n,d),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}else{var l=R(e,this.lastTouches,this.container);this.emit("tap",l),this.lastTap={time:Date.now(),position:l.touches[0]||l.previousTouches[0]}}}this.lastTouches=D(e.touches),this.startTouchesPositions=[]}}},{key:"handleMove",value:function(e){var t=this;if(this.enabled&&this.startTouchesPositions.length){e.preventDefault();var i=D(e.touches),a=i.map(function(e){return S(e,t.container)}),n=this.lastTouches;this.lastTouches=i,this.lastTouchesPositions=a;var r=R(e,n,this.container);if((this.emit("touchmove",r),!r.sigmaDefaultPrevented)&&(this.hasMoved||(this.hasMoved=a.some(function(e,i){var a=t.startTouchesPositions[i];return a&&(e.x!==a.x||e.y!==a.y)})),this.hasMoved)){this.isMoving=!0,this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){t.isMoving=!1},this.settings.dragTimeout);var s=this.renderer.getCamera(),o=this.startCameraState,h=this.renderer.getSetting("stagePadding");switch(this.touchMode){case 1:var d=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0]),l=d.x,u=d.y,c=this.renderer.viewportToFramedGraph(a[0]),g=c.x,v=c.y;s.setState({x:o.x+l-g,y:o.y+u-v});break;case 2:var m={x:.5,y:.5,angle:0,ratio:1},f=a[0],p=f.x,y=f.y,b=a[1],x=b.x,C=b.y,w=Math.atan2(C-y,x-p)-this.startTouchesAngle,E=Math.hypot(C-y,x-p)/this.startTouchesDistance,k=s.getBoundedRatio(o.ratio/E);m.ratio=k,m.angle=o.angle+w;var L=this.getDimensions(),P=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0],{cameraState:o}),T=Math.min(L.width,L.height)-2*h,N=T/L.width,M=T/L.height,G=k/T,F=p-T/2/N,z=y-T/2/M,I=[F*Math.cos(-m.angle)-z*Math.sin(-m.angle),z*Math.cos(-m.angle)+F*Math.sin(-m.angle)];F=I[0],z=I[1],m.x=P.x-F*G,m.y=P.y+z*G,s.setState(m)}}}}},{key:"setSettings",value:function(e){this.settings=e}}])}(M);function _(e){return function(e){if(Array.isArray(e))return(0,r.a)(e)}(e)||function(e){if("u">typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,r.b)(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){if(null==e)return{};var i,a,n=function(e,t){if(null==e)return{};var i={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;i[a]=e[a]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)i=r[a],-1===t.indexOf(i)&&({}).propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var U=(0,i.a)(function e(t,a){(0,i.b)(this,e),this.key=t,this.size=a},null,[{key:"compare",value:function(e,t){return e.size>t.size?-1:e.size<t.size||e.key>t.key?1:-1}}]),B=(0,i.a)(function e(){(0,i.b)(this,e),(0,t.a)(this,"width",0),(0,t.a)(this,"height",0),(0,t.a)(this,"cellSize",0),(0,t.a)(this,"columns",0),(0,t.a)(this,"rows",0),(0,t.a)(this,"cells",{})},[{key:"resizeAndClear",value:function(e,t){this.width=e.width,this.height=e.height,this.cellSize=t,this.columns=Math.ceil(e.width/t),this.rows=Math.ceil(e.height/t),this.cells={}}},{key:"getIndex",value:function(e){var t=Math.floor(e.x/this.cellSize);return Math.floor(e.y/this.cellSize)*this.columns+t}},{key:"add",value:function(e,t,i){var a=new U(e,t),n=this.getIndex(i),r=this.cells[n];r||(r=[],this.cells[n]=r),r.push(a)}},{key:"organize",value:function(){for(var e in this.cells)this.cells[e].sort(U.compare)}},{key:"getLabelsToDisplay",value:function(e,t){var i=this.cellSize*this.cellSize,a=Math.ceil(i/e/e*t/i),n=[];for(var r in this.cells)for(var s=this.cells[r],o=0;o<Math.min(a,s.length);o++)n.push(s[o].key);return n}}]),H=Object.prototype.hasOwnProperty,O=function(e){function a(e,r){var s,o,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,i.b)(this,a),o=(0,i.c)(this,a),(0,t.a)(o,"elements",{}),(0,t.a)(o,"canvasContexts",{}),(0,t.a)(o,"webGLContexts",{}),(0,t.a)(o,"pickingLayers",new Set),(0,t.a)(o,"textures",{}),(0,t.a)(o,"frameBuffers",{}),(0,t.a)(o,"activeListeners",{}),(0,t.a)(o,"labelGrid",new B),(0,t.a)(o,"nodeDataCache",{}),(0,t.a)(o,"edgeDataCache",{}),(0,t.a)(o,"nodeProgramIndex",{}),(0,t.a)(o,"edgeProgramIndex",{}),(0,t.a)(o,"nodesWithForcedLabels",new Set),(0,t.a)(o,"edgesWithForcedLabels",new Set),(0,t.a)(o,"nodeExtent",{x:[0,1],y:[0,1]}),(0,t.a)(o,"nodeZExtent",[1/0,-1/0]),(0,t.a)(o,"edgeZExtent",[1/0,-1/0]),(0,t.a)(o,"matrix",h()),(0,t.a)(o,"invMatrix",h()),(0,t.a)(o,"correctionRatio",1),(0,t.a)(o,"customBBox",null),(0,t.a)(o,"normalizationFunction",p({x:[0,1],y:[0,1]})),(0,t.a)(o,"graphToViewportRatio",1),(0,t.a)(o,"itemIDsIndex",{}),(0,t.a)(o,"nodeIndices",{}),(0,t.a)(o,"edgeIndices",{}),(0,t.a)(o,"width",0),(0,t.a)(o,"height",0),(0,t.a)(o,"pixelRatio",m()),(0,t.a)(o,"pickingDownSizingRatio",2*o.pixelRatio),(0,t.a)(o,"displayedNodeLabels",new Set),(0,t.a)(o,"displayedEdgeLabels",new Set),(0,t.a)(o,"highlightedNodes",new Set),(0,t.a)(o,"hoveredNode",null),(0,t.a)(o,"hoveredEdge",null),(0,t.a)(o,"renderFrame",null),(0,t.a)(o,"renderHighlightedNodesFrame",null),(0,t.a)(o,"needToProcess",!1),(0,t.a)(o,"checkEdgesEventsFrame",null),(0,t.a)(o,"nodePrograms",{}),(0,t.a)(o,"nodeHoverPrograms",{}),(0,t.a)(o,"edgePrograms",{}),(s=x({},C,d)).nodeProgramClasses=x({},w,s.nodeProgramClasses),s.edgeProgramClasses=x({},E,s.edgeProgramClasses),o.settings=s,k(o.settings);if(!(0,n.default)(e))throw Error("Sigma: invalid graph instance.");if(e.forEachNode(function(e,t){if(!Number.isFinite(t.x)||!Number.isFinite(t.y))throw Error("Sigma: Coordinates of node ".concat(e," are invalid. A node must have a numeric 'x' and 'y' attribute."))}),!(r instanceof HTMLElement))throw Error("Sigma: container should be an html element.");for(var l in o.graph=e,o.container=r,o.createWebGLContext("edges",{picking:d.enableEdgeEvents}),o.createCanvasContext("edgeLabels"),o.createWebGLContext("nodes",{picking:!0}),o.createCanvasContext("labels"),o.createCanvasContext("hovers"),o.createWebGLContext("hoverNodes"),o.createCanvasContext("mouse",{style:{touchAction:"none",userSelect:"none"}}),o.resize(),o.settings.nodeProgramClasses)o.registerNodeProgram(l,o.settings.nodeProgramClasses[l],o.settings.nodeHoverProgramClasses[l]);for(var u in o.settings.edgeProgramClasses)o.registerEdgeProgram(u,o.settings.edgeProgramClasses[u]);return o.camera=new L,o.bindCameraHandlers(),o.mouseCaptor=new F(o.elements.mouse,o),o.mouseCaptor.setSettings(o.settings),o.touchCaptor=new I(o.elements.mouse,o),o.touchCaptor.setSettings(o.settings),o.bindEventHandlers(),o.bindGraphHandlers(),o.handleSettingsUpdate(),o.refresh(),o}return(0,i._)(a,e),(0,i.a)(a,[{key:"registerNodeProgram",value:function(e,t,i){return this.nodePrograms[e]&&this.nodePrograms[e].kill(),this.nodeHoverPrograms[e]&&this.nodeHoverPrograms[e].kill(),this.nodePrograms[e]=new t(this.webGLContexts.nodes,this.frameBuffers.nodes,this),this.nodeHoverPrograms[e]=new(i||t)(this.webGLContexts.hoverNodes,null,this),this}},{key:"registerEdgeProgram",value:function(e,t){return this.edgePrograms[e]&&this.edgePrograms[e].kill(),this.edgePrograms[e]=new t(this.webGLContexts.edges,this.frameBuffers.edges,this),this}},{key:"unregisterNodeProgram",value:function(e){if(this.nodePrograms[e]){var t=this.nodePrograms,a=t[e],n=A(t,[e].map(i.d));a.kill(),this.nodePrograms=n}if(this.nodeHoverPrograms[e]){var r=this.nodeHoverPrograms,s=r[e],o=A(r,[e].map(i.d));s.kill(),this.nodePrograms=o}return this}},{key:"unregisterEdgeProgram",value:function(e){if(this.edgePrograms[e]){var t=this.edgePrograms,a=t[e],n=A(t,[e].map(i.d));a.kill(),this.edgePrograms=n}return this}},{key:"resetWebGLTexture",value:function(e){var t=this.webGLContexts[e],i=this.frameBuffers[e],a=this.textures[e];a&&t.deleteTexture(a);var n=t.createTexture();return t.bindFramebuffer(t.FRAMEBUFFER,i),t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0),this.textures[e]=n,this}},{key:"bindCameraHandlers",value:function(){var e=this;return this.activeListeners.camera=function(){e.scheduleRender()},this.camera.on("updated",this.activeListeners.camera),this}},{key:"unbindCameraHandlers",value:function(){return this.camera.removeListener("updated",this.activeListeners.camera),this}},{key:"getNodeAtPosition",value:function(e){var t=e.x,i=e.y,a=(0,r.g)(this.webGLContexts.nodes,this.frameBuffers.nodes,t,i,this.pixelRatio,this.pickingDownSizingRatio),n=r.c.apply(void 0,_(a)),s=this.itemIDsIndex[n];return s&&"node"===s.type?s.id:null}},{key:"bindEventHandlers",value:function(){var e=this;this.activeListeners.handleResize=function(){e.scheduleRefresh()},window.addEventListener("resize",this.activeListeners.handleResize),this.activeListeners.handleMove=function(i){var a=T(i),n={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}},r=e.getNodeAtPosition(a);if(r&&e.hoveredNode!==r&&!e.nodeDataCache[r].hidden){e.hoveredNode&&e.emit("leaveNode",(0,t._)((0,t._)({},n),{},{node:e.hoveredNode})),e.hoveredNode=r,e.emit("enterNode",(0,t._)((0,t._)({},n),{},{node:r})),e.scheduleHighlightedNodesRender();return}if(e.hoveredNode&&e.getNodeAtPosition(a)!==e.hoveredNode){var s=e.hoveredNode;e.hoveredNode=null,e.emit("leaveNode",(0,t._)((0,t._)({},n),{},{node:s})),e.scheduleHighlightedNodesRender();return}if(e.settings.enableEdgeEvents){var o=e.hoveredNode?null:e.getEdgeAtPoint(n.event.x,n.event.y);o!==e.hoveredEdge&&(e.hoveredEdge&&e.emit("leaveEdge",(0,t._)((0,t._)({},n),{},{edge:e.hoveredEdge})),o&&e.emit("enterEdge",(0,t._)((0,t._)({},n),{},{edge:o})),e.hoveredEdge=o)}},this.activeListeners.handleMoveBody=function(t){var i=T(t);e.emit("moveBody",{event:i,preventSigmaDefault:function(){i.preventSigmaDefault()}})},this.activeListeners.handleLeave=function(i){var a=T(i),n={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}};e.hoveredNode&&(e.emit("leaveNode",(0,t._)((0,t._)({},n),{},{node:e.hoveredNode})),e.scheduleHighlightedNodesRender()),e.settings.enableEdgeEvents&&e.hoveredEdge&&(e.emit("leaveEdge",(0,t._)((0,t._)({},n),{},{edge:e.hoveredEdge})),e.scheduleHighlightedNodesRender()),e.emit("leaveStage",(0,t._)({},n))},this.activeListeners.handleEnter=function(i){var a=T(i);e.emit("enterStage",(0,t._)({},{event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}}))};var i=function(i){return function(a){var n=T(a),r={event:n,preventSigmaDefault:function(){n.preventSigmaDefault()}},s=e.getNodeAtPosition(n);if(s)return e.emit("".concat(i,"Node"),(0,t._)((0,t._)({},r),{},{node:s}));if(e.settings.enableEdgeEvents){var o=e.getEdgeAtPoint(n.x,n.y);if(o)return e.emit("".concat(i,"Edge"),(0,t._)((0,t._)({},r),{},{edge:o}))}return e.emit("".concat(i,"Stage"),r)}};return this.activeListeners.handleClick=i("click"),this.activeListeners.handleRightClick=i("rightClick"),this.activeListeners.handleDoubleClick=i("doubleClick"),this.activeListeners.handleWheel=i("wheel"),this.activeListeners.handleDown=i("down"),this.activeListeners.handleUp=i("up"),this.mouseCaptor.on("mousemove",this.activeListeners.handleMove),this.mouseCaptor.on("mousemovebody",this.activeListeners.handleMoveBody),this.mouseCaptor.on("click",this.activeListeners.handleClick),this.mouseCaptor.on("rightClick",this.activeListeners.handleRightClick),this.mouseCaptor.on("doubleClick",this.activeListeners.handleDoubleClick),this.mouseCaptor.on("wheel",this.activeListeners.handleWheel),this.mouseCaptor.on("mousedown",this.activeListeners.handleDown),this.mouseCaptor.on("mouseup",this.activeListeners.handleUp),this.mouseCaptor.on("mouseleave",this.activeListeners.handleLeave),this.mouseCaptor.on("mouseenter",this.activeListeners.handleEnter),this.touchCaptor.on("touchdown",this.activeListeners.handleDown),this.touchCaptor.on("touchdown",this.activeListeners.handleMove),this.touchCaptor.on("touchup",this.activeListeners.handleUp),this.touchCaptor.on("touchmove",this.activeListeners.handleMove),this.touchCaptor.on("tap",this.activeListeners.handleClick),this.touchCaptor.on("doubletap",this.activeListeners.handleDoubleClick),this.touchCaptor.on("touchmove",this.activeListeners.handleMoveBody),this}},{key:"bindGraphHandlers",value:function(){var e=this,t=this.graph,i=new Set(["x","y","zIndex","type"]);return this.activeListeners.eachNodeAttributesUpdatedGraphUpdate=function(a){var n,r=null==(n=a.hints)?void 0:n.attributes;e.graph.forEachNode(function(t){return e.updateNode(t)});var s=!r||r.some(function(e){return i.has(e)});e.refresh({partialGraph:{nodes:t.nodes()},skipIndexation:!s,schedule:!0})},this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate=function(i){var a,n=null==(a=i.hints)?void 0:a.attributes;e.graph.forEachEdge(function(t){return e.updateEdge(t)});var r=n&&["zIndex","type"].some(function(e){return null==n?void 0:n.includes(e)});e.refresh({partialGraph:{edges:t.edges()},skipIndexation:!r,schedule:!0})},this.activeListeners.addNodeGraphUpdate=function(t){var i=t.key;e.addNode(i),e.refresh({partialGraph:{nodes:[i]},skipIndexation:!1,schedule:!0})},this.activeListeners.updateNodeGraphUpdate=function(t){var i=t.key;e.refresh({partialGraph:{nodes:[i]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropNodeGraphUpdate=function(t){var i=t.key;e.removeNode(i),e.refresh({schedule:!0})},this.activeListeners.addEdgeGraphUpdate=function(t){var i=t.key;e.addEdge(i),e.refresh({partialGraph:{edges:[i]},schedule:!0})},this.activeListeners.updateEdgeGraphUpdate=function(t){var i=t.key;e.refresh({partialGraph:{edges:[i]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropEdgeGraphUpdate=function(t){var i=t.key;e.removeEdge(i),e.refresh({schedule:!0})},this.activeListeners.clearEdgesGraphUpdate=function(){e.clearEdgeState(),e.clearEdgeIndices(),e.refresh({schedule:!0})},this.activeListeners.clearGraphUpdate=function(){e.clearEdgeState(),e.clearNodeState(),e.clearEdgeIndices(),e.clearNodeIndices(),e.refresh({schedule:!0})},t.on("nodeAdded",this.activeListeners.addNodeGraphUpdate),t.on("nodeDropped",this.activeListeners.dropNodeGraphUpdate),t.on("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),t.on("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),t.on("edgeAdded",this.activeListeners.addEdgeGraphUpdate),t.on("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),t.on("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),t.on("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),t.on("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),t.on("cleared",this.activeListeners.clearGraphUpdate),this}},{key:"unbindGraphHandlers",value:function(){var e=this.graph;e.removeListener("nodeAdded",this.activeListeners.addNodeGraphUpdate),e.removeListener("nodeDropped",this.activeListeners.dropNodeGraphUpdate),e.removeListener("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),e.removeListener("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),e.removeListener("edgeAdded",this.activeListeners.addEdgeGraphUpdate),e.removeListener("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),e.removeListener("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),e.removeListener("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),e.removeListener("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),e.removeListener("cleared",this.activeListeners.clearGraphUpdate)}},{key:"getEdgeAtPoint",value:function(e,t){var i=(0,r.g)(this.webGLContexts.edges,this.frameBuffers.edges,e,t,this.pixelRatio,this.pickingDownSizingRatio),a=r.c.apply(void 0,_(i)),n=this.itemIDsIndex[a];return n&&"edge"===n.type?n.id:null}},{key:"process",value:function(){var e=this;this.emit("beforeProcess");var t=this.graph,i=this.settings,a=this.getDimensions();if(this.nodeExtent=function(e){if(!e.order)return{x:[0,1],y:[0,1]};var t=1/0,i=-1/0,a=1/0,n=-1/0;return e.forEachNode(function(e,r){var s=r.x,o=r.y;s<t&&(t=s),s>i&&(i=s),o<a&&(a=o),o>n&&(n=o)}),{x:[t,i],y:[a,n]}}(this.graph),!this.settings.autoRescale){var n=a.width,r=a.height,s=this.nodeExtent,o=s.x,h=s.y;this.nodeExtent={x:[(o[0]+o[1])/2-n/2,(o[0]+o[1])/2+n/2],y:[(h[0]+h[1])/2-r/2,(h[0]+h[1])/2+r/2]}}this.normalizationFunction=p(this.customBBox||this.nodeExtent);var d=v(new L().getState(),a,this.getGraphDimensions(),this.getStagePadding());this.labelGrid.resizeAndClear(a,i.labelGridCellSize);for(var l={},u={},c={},g={},m=1,y=t.nodes(),b=0,x=y.length;b<x;b++){var C=y[b],w=this.nodeDataCache[C],E=t.getNodeAttributes(C);w.x=E.x,w.y=E.y,this.normalizationFunction.applyTo(w),"string"!=typeof w.label||w.hidden||this.labelGrid.add(C,w.size,this.framedGraphToViewport(w,{matrix:d})),l[w.type]=(l[w.type]||0)+1}for(var k in this.labelGrid.organize(),this.nodePrograms){if(!H.call(this.nodePrograms,k))throw Error('Sigma: could not find a suitable program for node type "'.concat(k,'"!'));this.nodePrograms[k].reallocate(l[k]||0),l[k]=0}this.settings.zIndex&&this.nodeZExtent[0]!==this.nodeZExtent[1]&&(y=f(this.nodeZExtent,function(t){return e.nodeDataCache[t].zIndex},y));for(var S=0,P=y.length;S<P;S++){var T=y[S];u[T]=m,g[u[T]]={type:"node",id:T},m++;var D=this.nodeDataCache[T];this.addNodeToProgram(T,u[T],l[D.type]++)}for(var R={},N=t.edges(),M=0,G=N.length;M<G;M++){var F=N[M],z=this.edgeDataCache[F];R[z.type]=(R[z.type]||0)+1}for(var I in this.settings.zIndex&&this.edgeZExtent[0]!==this.edgeZExtent[1]&&(N=f(this.edgeZExtent,function(t){return e.edgeDataCache[t].zIndex},N)),this.edgePrograms){if(!H.call(this.edgePrograms,I))throw Error('Sigma: could not find a suitable program for edge type "'.concat(I,'"!'));this.edgePrograms[I].reallocate(R[I]||0),R[I]=0}for(var _=0,A=N.length;_<A;_++){var U=N[_];c[U]=m,g[c[U]]={type:"edge",id:U},m++;var B=this.edgeDataCache[U];this.addEdgeToProgram(U,c[U],R[B.type]++)}return this.itemIDsIndex=g,this.nodeIndices=u,this.edgeIndices=c,this.emit("afterProcess"),this}},{key:"handleSettingsUpdate",value:function(e){var t=this,i=this.settings;if(this.camera.minRatio=i.minCameraRatio,this.camera.maxRatio=i.maxCameraRatio,this.camera.enabledZooming=i.enableCameraZooming,this.camera.enabledPanning=i.enableCameraPanning,this.camera.enabledRotation=i.enableCameraRotation,i.cameraPanBoundaries?this.camera.clean=function(e){return t.cleanCameraState(e,i.cameraPanBoundaries&&"object"===y(i.cameraPanBoundaries)?i.cameraPanBoundaries:{})}:this.camera.clean=null,this.camera.setState(this.camera.validateState(this.camera.getState())),e){if(e.edgeProgramClasses!==i.edgeProgramClasses){for(var a in i.edgeProgramClasses)i.edgeProgramClasses[a]!==e.edgeProgramClasses[a]&&this.registerEdgeProgram(a,i.edgeProgramClasses[a]);for(var n in e.edgeProgramClasses)i.edgeProgramClasses[n]||this.unregisterEdgeProgram(n)}if(e.nodeProgramClasses!==i.nodeProgramClasses||e.nodeHoverProgramClasses!==i.nodeHoverProgramClasses){for(var r in i.nodeProgramClasses)(i.nodeProgramClasses[r]!==e.nodeProgramClasses[r]||i.nodeHoverProgramClasses[r]!==e.nodeHoverProgramClasses[r])&&this.registerNodeProgram(r,i.nodeProgramClasses[r],i.nodeHoverProgramClasses[r]);for(var s in e.nodeProgramClasses)i.nodeProgramClasses[s]||this.unregisterNodeProgram(s)}}return this.mouseCaptor.setSettings(this.settings),this.touchCaptor.setSettings(this.settings),this}},{key:"cleanCameraState",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.tolerance,n=void 0===a?0:a,s=i.boundaries,o=(0,t._)({},e),h=s||this.nodeExtent,d=(0,r._)(h.x,2),l=d[0],u=d[1],c=(0,r._)(h.y,2),g=c[0],v=c[1],m=[this.graphToViewport({x:l,y:g},{cameraState:e}),this.graphToViewport({x:u,y:g},{cameraState:e}),this.graphToViewport({x:l,y:v},{cameraState:e}),this.graphToViewport({x:u,y:v},{cameraState:e})],f=1/0,p=-1/0,y=1/0,b=-1/0;m.forEach(function(e){var t=e.x,i=e.y;f=Math.min(f,t),p=Math.max(p,t),y=Math.min(y,i),b=Math.max(b,i)});var x=p-f,C=b-y,w=this.getDimensions(),E=w.width,k=w.height,L=0,S=0;if(x>=E?p<E-n?L=p-(E-n):f>n&&(L=f-n):p>E+n?L=p-(E+n):f<-n&&(L=f+n),C>=k?b<k-n?S=b-(k-n):y>n&&(S=y-n):b>k+n?S=b-(k+n):y<-n&&(S=y+n),L||S){var P=this.viewportToFramedGraph({x:0,y:0},{cameraState:e}),T=this.viewportToFramedGraph({x:L,y:S},{cameraState:e});L=T.x-P.x,S=T.y-P.y,o.x+=L,o.y+=S}return o}},{key:"renderLabels",value:function(){if(!this.settings.renderLabels)return this;var e=this.camera.getState(),i=this.labelGrid.getLabelsToDisplay(e.ratio,this.settings.labelDensity);b(i,this.nodesWithForcedLabels),this.displayedNodeLabels=new Set;for(var a=this.canvasContexts.labels,n=0,r=i.length;n<r;n++){var s=i[n],o=this.nodeDataCache[s];if(!this.displayedNodeLabels.has(s)&&!o.hidden){var h=this.framedGraphToViewport(o),d=h.x,l=h.y,u=this.scaleSize(o.size);if((o.forceLabel||!(u<this.settings.labelRenderedSizeThreshold))&&!(d<-150)&&!(d>this.width+150)&&!(l<-50)&&!(l>this.height+50)){this.displayedNodeLabels.add(s);var c=this.settings.defaultDrawNodeLabel,g=this.nodePrograms[o.type];((null==g?void 0:g.drawLabel)||c)(a,(0,t._)((0,t._)({key:s},o),{},{size:u,x:d,y:l}),this.settings)}}}return this}},{key:"renderEdgeLabels",value:function(){if(!this.settings.renderEdgeLabels)return this;var e,i,a,n,r,s,o=this.canvasContexts.edgeLabels;o.clearRect(0,0,this.width,this.height);var h=(i=(e={graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedNodeLabels,highlightedNodes:this.highlightedNodes}).graph,a=e.hoveredNode,n=e.highlightedNodes,r=e.displayedNodeLabels,s=[],i.forEachEdge(function(e,t,i,o){(i===a||o===a||n.has(i)||n.has(o)||r.has(i)&&r.has(o))&&s.push(e)}),s);b(h,this.edgesWithForcedLabels);for(var d=new Set,l=0,u=h.length;l<u;l++){var c=h[l],g=this.graph.extremities(c),v=this.nodeDataCache[g[0]],m=this.nodeDataCache[g[1]],f=this.edgeDataCache[c];if(!d.has(c)&&!f.hidden&&!v.hidden&&!m.hidden){var p=this.settings.defaultDrawEdgeLabel,y=this.edgePrograms[f.type];((null==y?void 0:y.drawLabel)||p)(o,(0,t._)((0,t._)({key:c},f),{},{size:this.scaleSize(f.size)}),(0,t._)((0,t._)((0,t._)({key:g[0]},v),this.framedGraphToViewport(v)),{},{size:this.scaleSize(v.size)}),(0,t._)((0,t._)((0,t._)({key:g[1]},m),this.framedGraphToViewport(m)),{},{size:this.scaleSize(m.size)}),this.settings),d.add(c)}}return this.displayedEdgeLabels=d,this}},{key:"renderHighlightedNodes",value:function(){var e=this,i=this.canvasContexts.hovers;i.clearRect(0,0,this.width,this.height);var a=function(a){var n=e.nodeDataCache[a],r=e.framedGraphToViewport(n),s=r.x,o=r.y,h=e.scaleSize(n.size),d=e.settings.defaultDrawNodeHover,l=e.nodePrograms[n.type];((null==l?void 0:l.drawHover)||d)(i,(0,t._)((0,t._)({key:a},n),{},{size:h,x:s,y:o}),e.settings)},n=[];this.hoveredNode&&!this.nodeDataCache[this.hoveredNode].hidden&&n.push(this.hoveredNode),this.highlightedNodes.forEach(function(t){t!==e.hoveredNode&&n.push(t)}),n.forEach(function(e){return a(e)});var r={};for(var s in n.forEach(function(t){var i=e.nodeDataCache[t].type;r[i]=(r[i]||0)+1}),this.nodeHoverPrograms)this.nodeHoverPrograms[s].reallocate(r[s]||0),r[s]=0;n.forEach(function(t){var i=e.nodeDataCache[t];e.nodeHoverPrograms[i.type].process(0,r[i.type]++,i)}),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT);var o=this.getRenderParams();for(var h in this.nodeHoverPrograms)this.nodeHoverPrograms[h].render(o)}},{key:"scheduleHighlightedNodesRender",value:function(){var e=this;this.renderHighlightedNodesFrame||this.renderFrame||(this.renderHighlightedNodesFrame=requestAnimationFrame(function(){e.renderHighlightedNodesFrame=null,e.renderHighlightedNodes(),e.renderEdgeLabels()}))}},{key:"render",value:function(){var e,t,i=this;this.emit("beforeRender");var a=function(){return i.emit("afterRender"),i};if(this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.resize(),this.needToProcess&&this.process(),this.needToProcess=!1,this.clear(),this.pickingLayers.forEach(function(e){return i.resetWebGLTexture(e)}),!this.graph.order)return a();var n=this.mouseCaptor,r=this.camera.isAnimated()||n.isMoving||n.draggedEvents||n.currentWheelDirection,s=this.camera.getState(),o=this.getDimensions(),h=this.getGraphDimensions(),d=this.getStagePadding();this.matrix=v(s,o,h,d),this.invMatrix=v(s,o,h,d,!0),this.correctionRatio=(e=this.matrix,1/Math.sqrt(Math.pow((t=g(e,{x:Math.cos(s.angle),y:Math.sin(s.angle)},0)).x,2)+Math.pow(t.y,2))/o.width),this.graphToViewportRatio=this.getGraphToViewportRatio();var l=this.getRenderParams();for(var u in this.nodePrograms)this.nodePrograms[u].render(l);if(!this.settings.hideEdgesOnMove||!r)for(var c in this.edgePrograms)this.edgePrograms[c].render(l);return this.settings.hideLabelsOnMove&&r||(this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes()),a()}},{key:"addNode",value:function(e){var t=Object.assign({},this.graph.getNodeAttributes(e));this.settings.nodeReducer&&(t=this.settings.nodeReducer(e,t));var i=function(e,t,i){if(!H.call(i,"x")||!H.call(i,"y"))throw Error('Sigma: could not find a valid position (x, y) for node "'.concat(t,'". All your nodes must have a number "x" and "y". Maybe your forgot to apply a layout or your "nodeReducer" is not returning the correct data?'));return i.color||(i.color=e.defaultNodeColor),i.label||""===i.label||(i.label=null),void 0!==i.label&&null!==i.label?i.label=""+i.label:i.label=null,i.size||(i.size=2),H.call(i,"hidden")||(i.hidden=!1),H.call(i,"highlighted")||(i.highlighted=!1),H.call(i,"forceLabel")||(i.forceLabel=!1),i.type&&""!==i.type||(i.type=e.defaultNodeType),i.zIndex||(i.zIndex=0),i}(this.settings,e,t);this.nodeDataCache[e]=i,this.nodesWithForcedLabels.delete(e),i.forceLabel&&!i.hidden&&this.nodesWithForcedLabels.add(e),this.highlightedNodes.delete(e),i.highlighted&&!i.hidden&&this.highlightedNodes.add(e),this.settings.zIndex&&(i.zIndex<this.nodeZExtent[0]&&(this.nodeZExtent[0]=i.zIndex),i.zIndex>this.nodeZExtent[1]&&(this.nodeZExtent[1]=i.zIndex))}},{key:"updateNode",value:function(e){this.addNode(e);var t=this.nodeDataCache[e];this.normalizationFunction.applyTo(t)}},{key:"removeNode",value:function(e){delete this.nodeDataCache[e],delete this.nodeProgramIndex[e],this.highlightedNodes.delete(e),this.hoveredNode===e&&(this.hoveredNode=null),this.nodesWithForcedLabels.delete(e)}},{key:"addEdge",value:function(e){var t,i,a=Object.assign({},this.graph.getEdgeAttributes(e));this.settings.edgeReducer&&(a=this.settings.edgeReducer(e,a));var n=(t=this.settings,(i=a).color||(i.color=t.defaultEdgeColor),i.label||(i.label=""),i.size||(i.size=.5),H.call(i,"hidden")||(i.hidden=!1),H.call(i,"forceLabel")||(i.forceLabel=!1),i.type&&""!==i.type||(i.type=t.defaultEdgeType),i.zIndex||(i.zIndex=0),i);this.edgeDataCache[e]=n,this.edgesWithForcedLabels.delete(e),n.forceLabel&&!n.hidden&&this.edgesWithForcedLabels.add(e),this.settings.zIndex&&(n.zIndex<this.edgeZExtent[0]&&(this.edgeZExtent[0]=n.zIndex),n.zIndex>this.edgeZExtent[1]&&(this.edgeZExtent[1]=n.zIndex))}},{key:"updateEdge",value:function(e){this.addEdge(e)}},{key:"removeEdge",value:function(e){delete this.edgeDataCache[e],delete this.edgeProgramIndex[e],this.hoveredEdge===e&&(this.hoveredEdge=null),this.edgesWithForcedLabels.delete(e)}},{key:"clearNodeIndices",value:function(){this.labelGrid=new B,this.nodeExtent={x:[0,1],y:[0,1]},this.nodeDataCache={},this.edgeProgramIndex={},this.nodesWithForcedLabels=new Set,this.nodeZExtent=[1/0,-1/0],this.highlightedNodes=new Set}},{key:"clearEdgeIndices",value:function(){this.edgeDataCache={},this.edgeProgramIndex={},this.edgesWithForcedLabels=new Set,this.edgeZExtent=[1/0,-1/0]}},{key:"clearIndices",value:function(){this.clearEdgeIndices(),this.clearNodeIndices()}},{key:"clearNodeState",value:function(){this.displayedNodeLabels=new Set,this.highlightedNodes=new Set,this.hoveredNode=null}},{key:"clearEdgeState",value:function(){this.displayedEdgeLabels=new Set,this.highlightedNodes=new Set,this.hoveredEdge=null}},{key:"clearState",value:function(){this.clearEdgeState(),this.clearNodeState()}},{key:"addNodeToProgram",value:function(e,t,i){var a=this.nodeDataCache[e],n=this.nodePrograms[a.type];if(!n)throw Error('Sigma: could not find a suitable program for node type "'.concat(a.type,'"!'));n.process(t,i,a),this.nodeProgramIndex[e]=i}},{key:"addEdgeToProgram",value:function(e,t,i){var a=this.edgeDataCache[e],n=this.edgePrograms[a.type];if(!n)throw Error('Sigma: could not find a suitable program for edge type "'.concat(a.type,'"!'));var r=this.graph.extremities(e),s=this.nodeDataCache[r[0]],o=this.nodeDataCache[r[1]];n.process(t,i,s,o,a),this.edgeProgramIndex[e]=i}},{key:"getRenderParams",value:function(){return{matrix:this.matrix,invMatrix:this.invMatrix,width:this.width,height:this.height,pixelRatio:this.pixelRatio,zoomRatio:this.camera.ratio,cameraAngle:this.camera.angle,sizeRatio:1/this.scaleSize(),correctionRatio:this.correctionRatio,downSizingRatio:this.pickingDownSizingRatio,minEdgeThickness:this.settings.minEdgeThickness,antiAliasingFeather:this.settings.antiAliasingFeather}}},{key:"getStagePadding",value:function(){var e=this.settings,t=e.stagePadding;return e.autoRescale&&t||0}},{key:"createLayer",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.elements[e])throw Error('Sigma: a layer named "'.concat(e,'" already exists'));var a=function(e,t,i){var a=document.createElement(e);if(t)for(var n in t)a.style[n]=t[n];if(i)for(var r in i)a.setAttribute(r,i[r]);return a}(t,{position:"absolute"},{class:"sigma-".concat(e)});return i.style&&Object.assign(a.style,i.style),this.elements[e]=a,"beforeLayer"in i&&i.beforeLayer?this.elements[i.beforeLayer].before(a):"afterLayer"in i&&i.afterLayer?this.elements[i.afterLayer].after(a):this.container.appendChild(a),a}},{key:"createCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.createLayer(e,"canvas",t)}},{key:"createCanvasContext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.createCanvas(e,t);return this.canvasContexts[e]=i.getContext("2d",{preserveDrawingBuffer:!1,antialias:!1}),this}},{key:"createWebGLContext",value:function(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(null==a?void 0:a.canvas)||this.createCanvas(e,a);a.hidden&&n.remove();var r=(0,t._)({preserveDrawingBuffer:!1,antialias:!1},a);(i=n.getContext("webgl2",r))||(i=n.getContext("webgl",r)),i||(i=n.getContext("experimental-webgl",r));var s=i;if(this.webGLContexts[e]=s,s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),a.picking){this.pickingLayers.add(e);var o=s.createFramebuffer();if(!o)throw Error("Sigma: cannot create a new frame buffer for layer ".concat(e));this.frameBuffers[e]=o}return s}},{key:"killLayer",value:function(e){var t,i=this.elements[e];if(!i)throw Error("Sigma: cannot kill layer ".concat(e,", which does not exist"));return this.webGLContexts[e]?(null==(t=this.webGLContexts[e].getExtension("WEBGL_lose_context"))||t.loseContext(),delete this.webGLContexts[e]):this.canvasContexts[e]&&delete this.canvasContexts[e],i.remove(),delete this.elements[e],this}},{key:"getCamera",value:function(){return this.camera}},{key:"setCamera",value:function(e){this.unbindCameraHandlers(),this.camera=e,this.bindCameraHandlers()}},{key:"getContainer",value:function(){return this.container}},{key:"getGraph",value:function(){return this.graph}},{key:"setGraph",value:function(e){e!==this.graph&&(this.hoveredNode&&!e.hasNode(this.hoveredNode)&&(this.hoveredNode=null),this.hoveredEdge&&!e.hasEdge(this.hoveredEdge)&&(this.hoveredEdge=null),this.unbindGraphHandlers(),null!==this.checkEdgesEventsFrame&&(cancelAnimationFrame(this.checkEdgesEventsFrame),this.checkEdgesEventsFrame=null),this.graph=e,this.bindGraphHandlers(),this.refresh())}},{key:"getMouseCaptor",value:function(){return this.mouseCaptor}},{key:"getTouchCaptor",value:function(){return this.touchCaptor}},{key:"getDimensions",value:function(){return{width:this.width,height:this.height}}},{key:"getGraphDimensions",value:function(){var e=this.customBBox||this.nodeExtent;return{width:e.x[1]-e.x[0]||1,height:e.y[1]-e.y[0]||1}}},{key:"getNodeDisplayData",value:function(e){var t=this.nodeDataCache[e];return t?Object.assign({},t):void 0}},{key:"getEdgeDisplayData",value:function(e){var t=this.edgeDataCache[e];return t?Object.assign({},t):void 0}},{key:"getNodeDisplayedLabels",value:function(){return new Set(this.displayedNodeLabels)}},{key:"getEdgeDisplayedLabels",value:function(){return new Set(this.displayedEdgeLabels)}},{key:"getSettings",value:function(){return(0,t._)({},this.settings)}},{key:"getSetting",value:function(e){return this.settings[e]}},{key:"setSetting",value:function(e,i){var a=(0,t._)({},this.settings);return this.settings[e]=i,k(this.settings),this.handleSettingsUpdate(a),this.scheduleRefresh(),this}},{key:"updateSetting",value:function(e,t){return this.setSetting(e,t(this.settings[e])),this}},{key:"setSettings",value:function(e){var i=(0,t._)({},this.settings);return this.settings=(0,t._)((0,t._)({},this.settings),e),k(this.settings),this.handleSettingsUpdate(i),this.scheduleRefresh(),this}},{key:"resize",value:function(e){var t=this.width,i=this.height;if(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.pixelRatio=m(),0===this.width)if(this.settings.allowInvalidContainer)this.width=1;else throw Error("Sigma: Container has no width. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(0===this.height)if(this.settings.allowInvalidContainer)this.height=1;else throw Error("Sigma: Container has no height. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(!e&&t===this.width&&i===this.height)return this;for(var a in this.elements){var n=this.elements[a];n.style.width=this.width+"px",n.style.height=this.height+"px"}for(var r in this.canvasContexts)this.elements[r].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[r].setAttribute("height",this.height*this.pixelRatio+"px"),1!==this.pixelRatio&&this.canvasContexts[r].scale(this.pixelRatio,this.pixelRatio);for(var s in this.webGLContexts){this.elements[s].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[s].setAttribute("height",this.height*this.pixelRatio+"px");var o=this.webGLContexts[s];if(o.viewport(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio),this.pickingLayers.has(s)){var h=this.textures[s];h&&o.deleteTexture(h)}}return this.emit("resize"),this}},{key:"clear",value:function(){return this.emit("beforeClear"),this.webGLContexts.nodes.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.nodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.edges.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.edges.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.hoverNodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.canvasContexts.labels.clearRect(0,0,this.width,this.height),this.canvasContexts.hovers.clearRect(0,0,this.width,this.height),this.canvasContexts.edgeLabels.clearRect(0,0,this.width,this.height),this.emit("afterClear"),this}},{key:"refresh",value:function(e){var t=this,i=(null==e?void 0:e.skipIndexation)!==void 0&&(null==e?void 0:e.skipIndexation),a=(null==e?void 0:e.schedule)!==void 0&&e.schedule,n=!e||!e.partialGraph;if(n)this.clearEdgeIndices(),this.clearNodeIndices(),this.graph.forEachNode(function(e){return t.addNode(e)}),this.graph.forEachEdge(function(e){return t.addEdge(e)});else{for(var r,s,o=(null==(r=e.partialGraph)?void 0:r.nodes)||[],h=0,d=(null==o?void 0:o.length)||0;h<d;h++){var l=o[h];if(this.updateNode(l),i){var u=this.nodeProgramIndex[l];if(void 0===u)throw Error('Sigma: node "'.concat(l,"\" can't be repaint"));this.addNodeToProgram(l,this.nodeIndices[l],u)}}for(var c=(null==e||null==(s=e.partialGraph)?void 0:s.edges)||[],g=0,v=c.length;g<v;g++){var m=c[g];if(this.updateEdge(m),i){var f=this.edgeProgramIndex[m];if(void 0===f)throw Error('Sigma: edge "'.concat(m,"\" can't be repaint"));this.addEdgeToProgram(m,this.edgeIndices[m],f)}}}return(n||!i)&&(this.needToProcess=!0),a?this.scheduleRender():this.render(),this}},{key:"scheduleRender",value:function(){var e=this;return this.renderFrame||(this.renderFrame=requestAnimationFrame(function(){e.render()})),this}},{key:"scheduleRefresh",value:function(e){return this.refresh((0,t._)((0,t._)({},e),{},{schedule:!0}))}},{key:"getViewportZoomedState",value:function(e,t){var i=this.camera.getState(),a=i.ratio,n=i.angle,r=i.x,s=i.y,o=this.settings,h=o.minCameraRatio,d=o.maxCameraRatio;"number"==typeof d&&(t=Math.min(t,d)),"number"==typeof h&&(t=Math.max(t,h));var l=t/a,u={x:this.width/2,y:this.height/2},c=this.viewportToFramedGraph(e),g=this.viewportToFramedGraph(u);return{angle:n,x:(c.x-g.x)*(1-l)+r,y:(c.y-g.y)*(1-l)+s,ratio:t}}},{key:"viewRectangle",value:function(){var e=this.viewportToFramedGraph({x:0,y:0}),t=this.viewportToFramedGraph({x:this.width,y:0}),i=this.viewportToFramedGraph({x:0,y:this.height});return{x1:e.x,y1:e.y,x2:t.x,y2:t.y,height:t.y-i.y}}},{key:"framedGraphToViewport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!!t.cameraState||!!t.viewportDimensions||!!t.graphDimensions,a=g(t.matrix?t.matrix:i?v(t.cameraState||this.camera.getState(),t.viewportDimensions||this.getDimensions(),t.graphDimensions||this.getGraphDimensions(),t.padding||this.getStagePadding()):this.matrix,e);return{x:(1+a.x)*this.width/2,y:(1-a.y)*this.height/2}}},{key:"viewportToFramedGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!!t.cameraState||!!t.viewportDimensions||!t.graphDimensions,a=g(t.matrix?t.matrix:i?v(t.cameraState||this.camera.getState(),t.viewportDimensions||this.getDimensions(),t.graphDimensions||this.getGraphDimensions(),t.padding||this.getStagePadding(),!0):this.invMatrix,{x:e.x/this.width*2-1,y:1-e.y/this.height*2});return isNaN(a.x)&&(a.x=0),isNaN(a.y)&&(a.y=0),a}},{key:"viewportToGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.normalizationFunction.inverse(this.viewportToFramedGraph(e,t))}},{key:"graphToViewport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.framedGraphToViewport(this.normalizationFunction(e),t)}},{key:"getGraphToViewportRatio",value:function(){var e={x:0,y:0},t={x:1,y:1},i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),a=this.graphToViewport(e),n=this.graphToViewport(t);return Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2))/i}},{key:"getBBox",value:function(){return this.nodeExtent}},{key:"getCustomBBox",value:function(){return this.customBBox}},{key:"setCustomBBox",value:function(e){return this.customBBox=e,this.scheduleRender(),this}},{key:"kill",value:function(){this.emit("kill"),this.removeAllListeners(),this.unbindCameraHandlers(),window.removeEventListener("resize",this.activeListeners.handleResize),this.mouseCaptor.kill(),this.touchCaptor.kill(),this.unbindGraphHandlers(),this.clearIndices(),this.clearState(),this.nodeDataCache={},this.edgeDataCache={},this.highlightedNodes.clear(),this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.renderHighlightedNodesFrame&&(cancelAnimationFrame(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null);for(var e=this.container;e.firstChild;)e.removeChild(e.firstChild);for(var t in this.nodePrograms)this.nodePrograms[t].kill();for(var i in this.nodeHoverPrograms)this.nodeHoverPrograms[i].kill();for(var a in this.edgePrograms)this.edgePrograms[a].kill();for(var n in this.nodePrograms={},this.nodeHoverPrograms={},this.edgePrograms={},this.elements)this.killLayer(n);this.canvasContexts={},this.webGLContexts={},this.elements={}}},{key:"scaleSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.camera.ratio;return e/this.settings.zoomToSizeRatioFunction(t)*("positions"===this.getSetting("itemSizesReference")?t*this.graphToViewportRatio:1)}},{key:"getCanvases",value:function(){var e={};for(var t in this.elements)this.elements[t]instanceof HTMLCanvasElement&&(e[t]=this.elements[t]);return e}}])}(a);e.s(["Camera",()=>L,"MouseCaptor",()=>F,"Sigma",()=>O,"TouchCaptor",()=>I,"default",()=>O],78058)}]);